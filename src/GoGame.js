// Generated by CoffeeScript 1.8.0
var GoGame;

GoGame = (function() {

  /*
  Constants
   */
  GoGame.PIECE = {
    EMPTY: null,
    BLACK: false,
    WHITE: true
  };


  /*
  Constructor
   */

  function GoGame(size) {
    var x, y, _i, _j, _ref, _ref1;
    if (size == null) {
      size = 9;
    }
    this.boardSize = size;
    this.board = [];
    this.turn = null;
    for (x = _i = 0, _ref = this.boardSize; 0 <= _ref ? _i < _ref : _i > _ref; x = 0 <= _ref ? ++_i : --_i) {
      this.board.push([]);
      for (y = _j = 0, _ref1 = this.boardSize; 0 <= _ref1 ? _j < _ref1 : _j > _ref1; y = 0 <= _ref1 ? ++_j : --_j) {
        this.board[x].push(this._createCell(x, y));
      }
    }
    this.turn = GoGame.PIECE.BLACK;
  }


  /*
  Game methods
   */

  GoGame.prototype.play = function(x, y) {
    this.board[x][y].value = this.turn;
    return this._alternateTurn();
  };

  GoGame.prototype.pass = function() {
    return this._alternateTurn();
  };


  /*
  Util methods
   */

  GoGame.prototype._createCell = function(x, y) {
    return {
      self: this,
      x: x,
      y: y,
      value: GoGame.PIECE.EMPTY,
      _up: null,
      _down: null,
      _left: null,
      _right: null,
      _surrounding: null,
      surroundingCells: function() {
        if (this._surrounding === null) {
          this._surrounding = [];
          if (this.up() != null) {
            this._surrounding.push(this.up());
          }
          if (this.down() != null) {
            this._surrounding.push(this.down());
          }
          if (this.left() != null) {
            this._surrounding.push(this.left());
          }
          if (this.right() != null) {
            this._surrounding.push(this.right());
          }
        }
        return this._surrounding;
      },
      up: function() {
        if (this._up === null && this.y - 1 >= 0) {
          this._up = this.self.board[this.x][this.y - 1];
        }
        return this._up;
      },
      down: function() {
        if (this._down === null && this.y + 1 < this.self.boardSize) {
          this._down = this.self.board[this.x][this.y + 1];
        }
        return this._down;
      },
      left: function() {
        if (this._left === null && this.x - 1 >= 0) {
          this._left = this.self.board[this.x - 1][this.y];
        }
        return this._left;
      },
      right: function() {
        if (this._right === null && this.x + 1 < this.self.boardSize) {
          this._right = this.self.board[this.x + 1][this.y];
        }
        return this._right;
      }
    };
  };

  GoGame.prototype._alternateTurn = function() {
    this.turn = !this.turn;
    return this;
  };

  GoGame.prototype.toString = function() {
    var string, x, y, _i, _j, _ref, _ref1;
    string = '';
    for (y = _i = 0, _ref = this.boardSize; 0 <= _ref ? _i < _ref : _i > _ref; y = 0 <= _ref ? ++_i : --_i) {
      for (x = _j = 0, _ref1 = this.boardSize; 0 <= _ref1 ? _j < _ref1 : _j > _ref1; x = 0 <= _ref1 ? ++_j : --_j) {
        string += (function() {
          switch (this.board[x][y].value) {
            case GoGame.PIECE.EMPTY:
              return '-';
            case GoGame.PIECE.BLACK:
              return 'b';
            case GoGame.PIECE.WHITE:
              return 'w';
          }
        }).call(this);
      }
      string += '\n';
    }
    return string;
  };

  return GoGame;

})();
